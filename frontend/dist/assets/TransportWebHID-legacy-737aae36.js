System.register(["./index-legacy-b17e8fc7.js"],(function(e,t){"use strict";var r,n,s,i,o,a,l,h;return{setters:[e=>{r=e.t,n=e.u,s=e.v,i=e.D,o=e.T,a=e.x,l=e.y,h=e.z}],execute:function(){var t={};const u=r(n);!function(e){e.__esModule=!0;var t=u,r={data:Buffer.alloc(0),dataLength:0,sequence:0};e.default=function(e,n){return{makeBlocks:function(t){var r,s,i=Buffer.concat([(r=t.length,s=Buffer.alloc(2),s.writeUInt16BE(r,0),s),t]),o=n-5,a=Math.ceil(i.length/o);i=Buffer.concat([i,Buffer.alloc(a*o-i.length+1).fill(0)]);for(var l=[],h=0;h<a;h++){var u=Buffer.alloc(5);u.writeUInt16BE(e,0),u.writeUInt8(5,2),u.writeUInt16BE(h,3);var c=i.slice(h*o,(h+1)*o);l.push(Buffer.concat([u,c]))}return l},reduceResponse:function(n,s){var i=n||r,o=i.data,a=i.dataLength,l=i.sequence;if(s.readUInt16BE(0)!==e)throw new t.TransportError("Invalid channel","InvalidChannel");if(5!==s.readUInt8(2))throw new t.TransportError("Invalid tag","InvalidTag");if(s.readUInt16BE(3)!==l)throw new t.TransportError("Invalid sequence","InvalidSequence");n||(a=s.readUInt16BE(5)),l++;var h=s.slice(n?5:7);return(o=Buffer.concat([o,h])).length>a&&(o=o.slice(0,a)),{data:o,dataLength:a,sequence:l}},getReducedResult:function(e){if(e&&e.dataLength===e.data.length)return e.data}}}}(t);const c=s(t);var p={exports:{}},f={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},v="object"==typeof process&&process.env&&{}.NODE_DEBUG&&/\bsemver\b/i.test({}.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};!function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:s}=f,i=v,o=(t=e.exports={}).re=[],a=t.safeRe=[],l=t.src=[],h=t.t={};let u=0;const c="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",s],[c,n]],E=(e,t,r)=>{const n=(e=>{for(const[t,r]of p)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e})(t),s=u++;i(e,s,t),h[e]=s,l[s]=t,o[s]=new RegExp(t,r?"g":void 0),a[s]=new RegExp(n,r?"g":void 0)};E("NUMERICIDENTIFIER","0|[1-9]\\d*"),E("NUMERICIDENTIFIERLOOSE","\\d+"),E("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${c}*`),E("MAINVERSION",`(${l[h.NUMERICIDENTIFIER]})\\.(${l[h.NUMERICIDENTIFIER]})\\.(${l[h.NUMERICIDENTIFIER]})`),E("MAINVERSIONLOOSE",`(${l[h.NUMERICIDENTIFIERLOOSE]})\\.(${l[h.NUMERICIDENTIFIERLOOSE]})\\.(${l[h.NUMERICIDENTIFIERLOOSE]})`),E("PRERELEASEIDENTIFIER",`(?:${l[h.NUMERICIDENTIFIER]}|${l[h.NONNUMERICIDENTIFIER]})`),E("PRERELEASEIDENTIFIERLOOSE",`(?:${l[h.NUMERICIDENTIFIERLOOSE]}|${l[h.NONNUMERICIDENTIFIER]})`),E("PRERELEASE",`(?:-(${l[h.PRERELEASEIDENTIFIER]}(?:\\.${l[h.PRERELEASEIDENTIFIER]})*))`),E("PRERELEASELOOSE",`(?:-?(${l[h.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[h.PRERELEASEIDENTIFIERLOOSE]})*))`),E("BUILDIDENTIFIER",`${c}+`),E("BUILD",`(?:\\+(${l[h.BUILDIDENTIFIER]}(?:\\.${l[h.BUILDIDENTIFIER]})*))`),E("FULLPLAIN",`v?${l[h.MAINVERSION]}${l[h.PRERELEASE]}?${l[h.BUILD]}?`),E("FULL",`^${l[h.FULLPLAIN]}$`),E("LOOSEPLAIN",`[v=\\s]*${l[h.MAINVERSIONLOOSE]}${l[h.PRERELEASELOOSE]}?${l[h.BUILD]}?`),E("LOOSE",`^${l[h.LOOSEPLAIN]}$`),E("GTLT","((?:<|>)?=?)"),E("XRANGEIDENTIFIERLOOSE",`${l[h.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),E("XRANGEIDENTIFIER",`${l[h.NUMERICIDENTIFIER]}|x|X|\\*`),E("XRANGEPLAIN",`[v=\\s]*(${l[h.XRANGEIDENTIFIER]})(?:\\.(${l[h.XRANGEIDENTIFIER]})(?:\\.(${l[h.XRANGEIDENTIFIER]})(?:${l[h.PRERELEASE]})?${l[h.BUILD]}?)?)?`),E("XRANGEPLAINLOOSE",`[v=\\s]*(${l[h.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[h.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[h.XRANGEIDENTIFIERLOOSE]})(?:${l[h.PRERELEASELOOSE]})?${l[h.BUILD]}?)?)?`),E("XRANGE",`^${l[h.GTLT]}\\s*${l[h.XRANGEPLAIN]}$`),E("XRANGELOOSE",`^${l[h.GTLT]}\\s*${l[h.XRANGEPLAINLOOSE]}$`),E("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),E("COERCERTL",l[h.COERCE],!0),E("LONETILDE","(?:~>?)"),E("TILDETRIM",`(\\s*)${l[h.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",E("TILDE",`^${l[h.LONETILDE]}${l[h.XRANGEPLAIN]}$`),E("TILDELOOSE",`^${l[h.LONETILDE]}${l[h.XRANGEPLAINLOOSE]}$`),E("LONECARET","(?:\\^)"),E("CARETTRIM",`(\\s*)${l[h.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",E("CARET",`^${l[h.LONECARET]}${l[h.XRANGEPLAIN]}$`),E("CARETLOOSE",`^${l[h.LONECARET]}${l[h.XRANGEPLAINLOOSE]}$`),E("COMPARATORLOOSE",`^${l[h.GTLT]}\\s*(${l[h.LOOSEPLAIN]})$|^$`),E("COMPARATOR",`^${l[h.GTLT]}\\s*(${l[h.FULLPLAIN]})$|^$`),E("COMPARATORTRIM",`(\\s*)${l[h.GTLT]}\\s*(${l[h.LOOSEPLAIN]}|${l[h.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",E("HYPHENRANGE",`^\\s*(${l[h.XRANGEPLAIN]})\\s+-\\s+(${l[h.XRANGEPLAIN]})\\s*$`),E("HYPHENRANGELOOSE",`^\\s*(${l[h.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[h.XRANGEPLAINLOOSE]})\\s*$`),E("STAR","(<|>)?=?\\s*\\*"),E("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),E("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(p,p.exports);var E=p.exports;const d=Object.freeze({loose:!0}),m=Object.freeze({});var g=e=>e?"object"!=typeof e?d:e:m;const I=/^[0-9]+$/,$=(e,t)=>{const r=I.test(e),n=I.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1};var R={compareIdentifiers:$,rcompareIdentifiers:(e,t)=>$(t,e)};const w=v,{MAX_LENGTH:y,MAX_SAFE_INTEGER:N}=f,{safeRe:S,t:L}=E,A=g,{compareIdentifiers:O}=R;var T=class e{constructor(t,r){if(r=A(r),t instanceof e){if(t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease)return t;t=t.version}else if("string"!=typeof t)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>y)throw new TypeError(`version is longer than ${y} characters`);w("SemVer",t,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;const n=t.trim().match(r.loose?S[L.LOOSE]:S[L.FULL]);if(!n)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>N||this.major<0)throw new TypeError("Invalid major version");if(this.minor>N||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>N||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<N)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(w("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if("string"==typeof t&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof e||(t=new e(t,this.options)),O(this.major,t.major)||O(this.minor,t.minor)||O(this.patch,t.patch)}comparePre(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let r=0;do{const e=this.prerelease[r],n=t.prerelease[r];if(w("prerelease compare",r,e,n),void 0===e&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===e)return-1;if(e!==n)return O(e,n)}while(++r)}compareBuild(t){t instanceof e||(t=new e(t,this.options));let r=0;do{const e=this.build[r],n=t.build[r];if(w("prerelease compare",r,e,n),void 0===e&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===e)return-1;if(e!==n)return O(e,n)}while(++r)}inc(e,t,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let n=this.prerelease.length;for(;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);if(-1===n){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let n=[t,e];!1===r&&(n=[t]),0===O(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=n):this.prerelease=n}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};const b=T;var P=(e,t,r=!1)=>{if(e instanceof b)return e;try{return new b(e,t)}catch(n){if(!r)return null;throw n}};const x=P;var M=(e,t)=>{const r=x(e,t);return r?r.version:null};const C=P;var D=(e,t)=>{const r=C(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null};const _=T;var G=(e,t,r,n,s)=>{"string"==typeof r&&(s=n,n=r,r=void 0);try{return new _(e instanceof _?e.version:e,r).inc(t,n,s).version}catch(i){return null}};const U=P;var j=(e,t)=>{const r=U(e,null,!0),n=U(t,null,!0),s=r.compare(n);if(0===s)return null;const i=s>0,o=i?r:n,a=i?n:r,l=!!o.prerelease.length;if(a.prerelease.length&&!l)return a.patch||a.minor?o.patch?"patch":o.minor?"minor":"major":"major";const h=l?"pre":"";return r.major!==n.major?h+"major":r.minor!==n.minor?h+"minor":r.patch!==n.patch?h+"patch":"prerelease"};const F=T;var k=(e,t)=>new F(e,t).major;const X=T;var B=(e,t)=>new X(e,t).minor;const z=T;var V=(e,t)=>new z(e,t).patch;const H=P;var Y=(e,t)=>{const r=H(e,t);return r&&r.prerelease.length?r.prerelease:null};const q=T;var W=(e,t,r)=>new q(e,r).compare(new q(t,r));const Z=W;var K=(e,t,r)=>Z(t,e,r);const J=W;var Q=(e,t)=>J(e,t,!0);const ee=T;var te=(e,t,r)=>{const n=new ee(e,r),s=new ee(t,r);return n.compare(s)||n.compareBuild(s)};const re=te;var ne=(e,t)=>e.sort(((e,r)=>re(e,r,t)));const se=te;var ie=(e,t)=>e.sort(((e,r)=>se(r,e,t)));const oe=W;var ae=(e,t,r)=>oe(e,t,r)>0;const le=W;var he=(e,t,r)=>le(e,t,r)<0;const ue=W;var ce=(e,t,r)=>0===ue(e,t,r);const pe=W;var fe=(e,t,r)=>0!==pe(e,t,r);const ve=W;var Ee=(e,t,r)=>ve(e,t,r)>=0;const de=W;var me=(e,t,r)=>de(e,t,r)<=0;const ge=ce,Ie=fe,$e=ae,Re=Ee,we=he,ye=me;var Ne=(e,t,r,n)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return ge(e,r,n);case"!=":return Ie(e,r,n);case">":return $e(e,r,n);case">=":return Re(e,r,n);case"<":return we(e,r,n);case"<=":return ye(e,r,n);default:throw new TypeError(`Invalid operator: ${t}`)}};const Se=T,Le=P,{safeRe:Ae,t:Oe}=E;var Te,be,Pe=(e,t)=>{if(e instanceof Se)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){let t;for(;(t=Ae[Oe.COERCERTL].exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&t.index+t[0].length===r.index+r[0].length||(r=t),Ae[Oe.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;Ae[Oe.COERCERTL].lastIndex=-1}else r=e.match(Ae[Oe.COERCE]);return null===r?null:Le(`${r[2]}.${r[3]||"0"}.${r[4]||"0"}`,t)},xe=Me;function Me(e){var t=this;if(t instanceof Me||(t=new Me),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var r=0,n=arguments.length;r<n;r++)t.push(arguments[r]);return t}function Ce(e,t,r,n){if(!(this instanceof Ce))return new Ce(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}Me.Node=Ce,Me.create=Me,Me.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},Me.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},Me.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},Me.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)n=arguments[e],(r=this).tail=new Ce(n,r.tail,null,r),r.head||(r.head=r.tail),r.length++;var r,n;return this.length},Me.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)n=arguments[e],(r=this).head=new Ce(n,null,r.head,r),r.tail||(r.tail=r.head),r.length++;var r,n;return this.length},Me.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},Me.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},Me.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},Me.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},Me.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},Me.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},Me.prototype.map=function(e,t){t=t||this;for(var r=new Me,n=this.head;null!==n;)r.push(e.call(t,n.value,this)),n=n.next;return r},Me.prototype.mapReverse=function(e,t){t=t||this;for(var r=new Me,n=this.tail;null!==n;)r.push(e.call(t,n.value,this)),n=n.prev;return r},Me.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var s=0;null!==n;s++)r=e(r,n.value,s),n=n.next;return r},Me.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var s=this.length-1;null!==n;s--)r=e(r,n.value,s),n=n.prev;return r},Me.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},Me.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},Me.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new Me;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=0,s=this.head;null!==s&&n<e;n++)s=s.next;for(;null!==s&&n<t;n++,s=s.next)r.push(s.value);return r},Me.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new Me;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=this.length,s=this.tail;null!==s&&n>t;n--)s=s.prev;for(;null!==s&&n>e;n--,s=s.prev)r.push(s.value);return r},Me.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,s=this.head;null!==s&&n<e;n++)s=s.next;var i,o,a,l,h=[];for(n=0;s&&n<t;n++)h.push(s.value),s=this.removeNode(s);for(null===s&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev),n=0;n<r.length;n++)i=this,o=s,a=r[n],l=void 0,null===(l=o===i.head?new Ce(a,null,o,i):new Ce(a,o,o.next,i)).next&&(i.tail=l),null===l.prev&&(i.head=l),i.length++,s=l;return h},Me.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{(be||(be=1,Te=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),Te)(Me)}catch(Pr){}const De=xe,_e=Symbol("max"),Ge=Symbol("length"),Ue=Symbol("lengthCalculator"),je=Symbol("allowStale"),Fe=Symbol("maxAge"),ke=Symbol("dispose"),Xe=Symbol("noDisposeOnSet"),Be=Symbol("lruList"),ze=Symbol("cache"),Ve=Symbol("updateAgeOnGet"),He=()=>1,Ye=(e,t,r)=>{const n=e[ze].get(t);if(n){const t=n.value;if(qe(e,t)){if(Ze(e,n),!e[je])return}else r&&(e[Ve]&&(n.value.now=Date.now()),e[Be].unshiftNode(n));return t.value}},qe=(e,t)=>{if(!t||!t.maxAge&&!e[Fe])return!1;const r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[Fe]&&r>e[Fe]},We=e=>{if(e[Ge]>e[_e])for(let t=e[Be].tail;e[Ge]>e[_e]&&null!==t;){const r=t.prev;Ze(e,t),t=r}},Ze=(e,t)=>{if(t){const r=t.value;e[ke]&&e[ke](r.key,r.value),e[Ge]-=r.length,e[ze].delete(r.key),e[Be].removeNode(t)}};class Ke{constructor(e,t,r,n,s){this.key=e,this.value=t,this.length=r,this.now=n,this.maxAge=s||0}}const Je=(e,t,r,n)=>{let s=r.value;qe(e,s)&&(Ze(e,r),e[je]||(s=void 0)),s&&t.call(n,s.value,s.key,e)};var Qe,et,tt,rt,nt=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[_e]=e.max||1/0;const t=e.length||He;if(this[Ue]="function"!=typeof t?He:t,this[je]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[Fe]=e.maxAge||0,this[ke]=e.dispose,this[Xe]=e.noDisposeOnSet||!1,this[Ve]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[_e]=e||1/0,We(this)}get max(){return this[_e]}set allowStale(e){this[je]=!!e}get allowStale(){return this[je]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[Fe]=e,We(this)}get maxAge(){return this[Fe]}set lengthCalculator(e){"function"!=typeof e&&(e=He),e!==this[Ue]&&(this[Ue]=e,this[Ge]=0,this[Be].forEach((e=>{e.length=this[Ue](e.value,e.key),this[Ge]+=e.length}))),We(this)}get lengthCalculator(){return this[Ue]}get length(){return this[Ge]}get itemCount(){return this[Be].length}rforEach(e,t){t=t||this;for(let r=this[Be].tail;null!==r;){const n=r.prev;Je(this,e,r,t),r=n}}forEach(e,t){t=t||this;for(let r=this[Be].head;null!==r;){const n=r.next;Je(this,e,r,t),r=n}}keys(){return this[Be].toArray().map((e=>e.key))}values(){return this[Be].toArray().map((e=>e.value))}reset(){this[ke]&&this[Be]&&this[Be].length&&this[Be].forEach((e=>this[ke](e.key,e.value))),this[ze]=new Map,this[Be]=new De,this[Ge]=0}dump(){return this[Be].map((e=>!qe(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[Be]}set(e,t,r){if((r=r||this[Fe])&&"number"!=typeof r)throw new TypeError("maxAge must be a number");const n=r?Date.now():0,s=this[Ue](t,e);if(this[ze].has(e)){if(s>this[_e])return Ze(this,this[ze].get(e)),!1;const i=this[ze].get(e).value;return this[ke]&&(this[Xe]||this[ke](e,i.value)),i.now=n,i.maxAge=r,i.value=t,this[Ge]+=s-i.length,i.length=s,this.get(e),We(this),!0}const i=new Ke(e,t,s,n,r);return i.length>this[_e]?(this[ke]&&this[ke](e,t),!1):(this[Ge]+=i.length,this[Be].unshift(i),this[ze].set(e,this[Be].head),We(this),!0)}has(e){if(!this[ze].has(e))return!1;const t=this[ze].get(e).value;return!qe(this,t)}get(e){return Ye(this,e,!0)}peek(e){return Ye(this,e,!1)}pop(){const e=this[Be].tail;return e?(Ze(this,e),e.value):null}del(e){Ze(this,this[ze].get(e))}load(e){this.reset();const t=Date.now();for(let r=e.length-1;r>=0;r--){const n=e[r],s=n.e||0;if(0===s)this.set(n.k,n.v);else{const e=s-t;e>0&&this.set(n.k,n.v,e)}}}prune(){this[ze].forEach(((e,t)=>Ye(this,t,!1)))}};function st(){if(et)return Qe;et=1;class e{constructor(t,s){if(s=r(s),t instanceof e)return t.loose===!!s.loose&&t.includePrerelease===!!s.includePrerelease?t:new e(t.raw,s);if(t instanceof n)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=s,this.loose=!!s.loose,this.includePrerelease=!!s.includePrerelease,this.raw=t.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!d(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const t of this.set)if(1===t.length&&m(t[0])){this.set=[t];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const r=((this.options.includePrerelease&&c)|(this.options.loose&&p))+":"+e,i=t.get(r);if(i)return i;const f=this.options.loose,v=f?o[a.HYPHENRANGELOOSE]:o[a.HYPHENRANGE];e=e.replace(v,P(this.options.includePrerelease)),s("hyphen replace",e),e=e.replace(o[a.COMPARATORTRIM],l),s("comparator trim",e),e=e.replace(o[a.TILDETRIM],h),s("tilde trim",e),e=e.replace(o[a.CARETTRIM],u),s("caret trim",e);let E=e.split(" ").map((e=>$(e,this.options))).join(" ").split(/\s+/).map((e=>b(e,this.options)));f&&(E=E.filter((e=>(s("loose invalid filter",e,this.options),!!e.match(o[a.COMPARATORLOOSE]))))),s("range list",E);const m=new Map,g=E.map((e=>new n(e,this.options)));for(const t of g){if(d(t))return[t];m.set(t.value,t)}m.size>1&&m.has("")&&m.delete("");const I=[...m.values()];return t.set(r,I),I}intersects(t,r){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some((e=>I(e,r)&&t.set.some((t=>I(t,r)&&e.every((e=>t.every((t=>e.intersects(t,r)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new i(e,this.options)}catch(Pr){return!1}for(let t=0;t<this.set.length;t++)if(x(this.set[t],e,this.options))return!0;return!1}}Qe=e;const t=new nt({max:1e3}),r=g,n=it(),s=v,i=T,{safeRe:o,t:a,comparatorTrimReplace:l,tildeTrimReplace:h,caretTrimReplace:u}=E,{FLAG_INCLUDE_PRERELEASE:c,FLAG_LOOSE:p}=f,d=e=>"<0.0.0-0"===e.value,m=e=>""===e.value,I=(e,t)=>{let r=!0;const n=e.slice();let s=n.pop();for(;r&&n.length;)r=n.every((e=>s.intersects(e,t))),s=n.pop();return r},$=(e,t)=>(s("comp",e,t),e=N(e,t),s("caret",e),e=w(e,t),s("tildes",e),e=L(e,t),s("xrange",e),e=O(e,t),s("stars",e),e),R=e=>!e||"x"===e.toLowerCase()||"*"===e,w=(e,t)=>e.trim().split(/\s+/).map((e=>y(e,t))).join(" "),y=(e,t)=>{const r=t.loose?o[a.TILDELOOSE]:o[a.TILDE];return e.replace(r,((t,r,n,i,o)=>{let a;return s("tilde",e,t,r,n,i,o),R(r)?a="":R(n)?a=`>=${r}.0.0 <${+r+1}.0.0-0`:R(i)?a=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`:o?(s("replaceTilde pr",o),a=`>=${r}.${n}.${i}-${o} <${r}.${+n+1}.0-0`):a=`>=${r}.${n}.${i} <${r}.${+n+1}.0-0`,s("tilde return",a),a}))},N=(e,t)=>e.trim().split(/\s+/).map((e=>S(e,t))).join(" "),S=(e,t)=>{s("caret",e,t);const r=t.loose?o[a.CARETLOOSE]:o[a.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,((t,r,i,o,a)=>{let l;return s("caret",e,t,r,i,o,a),R(r)?l="":R(i)?l=`>=${r}.0.0${n} <${+r+1}.0.0-0`:R(o)?l="0"===r?`>=${r}.${i}.0${n} <${r}.${+i+1}.0-0`:`>=${r}.${i}.0${n} <${+r+1}.0.0-0`:a?(s("replaceCaret pr",a),l="0"===r?"0"===i?`>=${r}.${i}.${o}-${a} <${r}.${i}.${+o+1}-0`:`>=${r}.${i}.${o}-${a} <${r}.${+i+1}.0-0`:`>=${r}.${i}.${o}-${a} <${+r+1}.0.0-0`):(s("no pr"),l="0"===r?"0"===i?`>=${r}.${i}.${o}${n} <${r}.${i}.${+o+1}-0`:`>=${r}.${i}.${o}${n} <${r}.${+i+1}.0-0`:`>=${r}.${i}.${o} <${+r+1}.0.0-0`),s("caret return",l),l}))},L=(e,t)=>(s("replaceXRanges",e,t),e.split(/\s+/).map((e=>A(e,t))).join(" ")),A=(e,t)=>{e=e.trim();const r=t.loose?o[a.XRANGELOOSE]:o[a.XRANGE];return e.replace(r,((r,n,i,o,a,l)=>{s("xRange",e,r,n,i,o,a,l);const h=R(i),u=h||R(o),c=u||R(a),p=c;return"="===n&&p&&(n=""),l=t.includePrerelease?"-0":"",h?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&p?(u&&(o=0),a=0,">"===n?(n=">=",u?(i=+i+1,o=0,a=0):(o=+o+1,a=0)):"<="===n&&(n="<",u?i=+i+1:o=+o+1),"<"===n&&(l="-0"),r=`${n+i}.${o}.${a}${l}`):u?r=`>=${i}.0.0${l} <${+i+1}.0.0-0`:c&&(r=`>=${i}.${o}.0${l} <${i}.${+o+1}.0-0`),s("xRange return",r),r}))},O=(e,t)=>(s("replaceStars",e,t),e.trim().replace(o[a.STAR],"")),b=(e,t)=>(s("replaceGTE0",e,t),e.trim().replace(o[t.includePrerelease?a.GTE0PRE:a.GTE0],"")),P=e=>(t,r,n,s,i,o,a,l,h,u,c,p,f)=>`${r=R(n)?"":R(s)?`>=${n}.0.0${e?"-0":""}`:R(i)?`>=${n}.${s}.0${e?"-0":""}`:o?`>=${r}`:`>=${r}${e?"-0":""}`} ${l=R(h)?"":R(u)?`<${+h+1}.0.0-0`:R(c)?`<${h}.${+u+1}.0-0`:p?`<=${h}.${u}.${c}-${p}`:e?`<${h}.${u}.${+c+1}-0`:`<=${l}`}`.trim(),x=(e,t,r)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(s(e[r].semver),e[r].semver!==n.ANY&&e[r].semver.prerelease.length>0){const n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0};return Qe}function it(){if(rt)return tt;rt=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(n,s){if(s=r(s),n instanceof t){if(n.loose===!!s.loose)return n;n=n.value}n=n.trim().split(/\s+/).join(" "),o("comparator",n,s),this.options=s,this.loose=!!s.loose,this.parse(n),this.semver===e?this.value="":this.value=this.operator+this.semver.version,o("comp",this)}parse(t){const r=this.options.loose?n[s.COMPARATORLOOSE]:n[s.COMPARATOR],i=t.match(r);if(!i)throw new TypeError(`Invalid comparator: ${t}`);this.operator=void 0!==i[1]?i[1]:"","="===this.operator&&(this.operator=""),i[2]?this.semver=new a(i[2],this.options.loose):this.semver=e}toString(){return this.value}test(t){if(o("Comparator.test",t,this.options.loose),this.semver===e||t===e)return!0;if("string"==typeof t)try{t=new a(t,this.options)}catch(Pr){return!1}return i(t,this.operator,this.semver,this.options)}intersects(e,n){if(!(e instanceof t))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new l(e.value,n).test(this.value):""===e.operator?""===e.value||new l(this.value,n).test(e.semver):!((n=r(n)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!n.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(i(this.semver,"<",e.semver,n)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(i(this.semver,">",e.semver,n)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}tt=t;const r=g,{safeRe:n,t:s}=E,i=Ne,o=v,a=T,l=st();return tt}const ot=st();var at=(e,t,r)=>{try{t=new ot(t,r)}catch(Pr){return!1}return t.test(e)};const lt=st();var ht=(e,t)=>new lt(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")));const ut=T,ct=st();var pt=(e,t,r)=>{let n=null,s=null,i=null;try{i=new ct(t,r)}catch(Pr){return null}return e.forEach((e=>{i.test(e)&&(n&&-1!==s.compare(e)||(n=e,s=new ut(n,r)))})),n};const ft=T,vt=st();var Et=(e,t,r)=>{let n=null,s=null,i=null;try{i=new vt(t,r)}catch(Pr){return null}return e.forEach((e=>{i.test(e)&&(n&&1!==s.compare(e)||(n=e,s=new ft(n,r)))})),n};const dt=T,mt=st(),gt=ae;var It=(e,t)=>{e=new mt(e,t);let r=new dt("0.0.0");if(e.test(r))return r;if(r=new dt("0.0.0-0"),e.test(r))return r;r=null;for(let n=0;n<e.set.length;++n){const t=e.set[n];let s=null;t.forEach((e=>{const t=new dt(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!gt(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!s||r&&!gt(r,s)||(r=s)}return r&&e.test(r)?r:null};const $t=st();var Rt=(e,t)=>{try{return new $t(e,t).range||"*"}catch(Pr){return null}};const wt=T,yt=it(),{ANY:Nt}=yt,St=st(),Lt=at,At=ae,Ot=he,Tt=me,bt=Ee;var Pt=(e,t,r,n)=>{let s,i,o,a,l;switch(e=new wt(e,n),t=new St(t,n),r){case">":s=At,i=Tt,o=Ot,a=">",l=">=";break;case"<":s=Ot,i=bt,o=At,a="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Lt(e,t,n))return!1;for(let h=0;h<t.set.length;++h){const r=t.set[h];let u=null,c=null;if(r.forEach((e=>{e.semver===Nt&&(e=new yt(">=0.0.0")),u=u||e,c=c||e,s(e.semver,u.semver,n)?u=e:o(e.semver,c.semver,n)&&(c=e)})),u.operator===a||u.operator===l)return!1;if((!c.operator||c.operator===a)&&i(e,c.semver))return!1;if(c.operator===l&&o(e,c.semver))return!1}return!0};const xt=Pt;var Mt=(e,t,r)=>xt(e,t,">",r);const Ct=Pt;var Dt=(e,t,r)=>Ct(e,t,"<",r);const _t=st();var Gt=(e,t,r)=>(e=new _t(e,r),t=new _t(t,r),e.intersects(t,r));const Ut=at,jt=W,Ft=st(),kt=it(),{ANY:Xt}=kt,Bt=at,zt=W,Vt=[new kt(">=0.0.0-0")],Ht=[new kt(">=0.0.0")],Yt=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===Xt){if(1===t.length&&t[0].semver===Xt)return!0;e=r.includePrerelease?Vt:Ht}if(1===t.length&&t[0].semver===Xt){if(r.includePrerelease)return!0;t=Ht}const n=new Set;let s,i,o,a,l,h,u;for(const f of e)">"===f.operator||">="===f.operator?s=qt(s,f,r):"<"===f.operator||"<="===f.operator?i=Wt(i,f,r):n.add(f.semver);if(n.size>1)return null;if(s&&i){if(o=zt(s.semver,i.semver,r),o>0)return null;if(0===o&&(">="!==s.operator||"<="!==i.operator))return null}for(const f of n){if(s&&!Bt(f,String(s),r))return null;if(i&&!Bt(f,String(i),r))return null;for(const e of t)if(!Bt(f,String(e),r))return!1;return!0}let c=!(!i||r.includePrerelease||!i.semver.prerelease.length)&&i.semver,p=!(!s||r.includePrerelease||!s.semver.prerelease.length)&&s.semver;c&&1===c.prerelease.length&&"<"===i.operator&&0===c.prerelease[0]&&(c=!1);for(const f of t){if(u=u||">"===f.operator||">="===f.operator,h=h||"<"===f.operator||"<="===f.operator,s)if(p&&f.semver.prerelease&&f.semver.prerelease.length&&f.semver.major===p.major&&f.semver.minor===p.minor&&f.semver.patch===p.patch&&(p=!1),">"===f.operator||">="===f.operator){if(a=qt(s,f,r),a===f&&a!==s)return!1}else if(">="===s.operator&&!Bt(s.semver,String(f),r))return!1;if(i)if(c&&f.semver.prerelease&&f.semver.prerelease.length&&f.semver.major===c.major&&f.semver.minor===c.minor&&f.semver.patch===c.patch&&(c=!1),"<"===f.operator||"<="===f.operator){if(l=Wt(i,f,r),l===f&&l!==i)return!1}else if("<="===i.operator&&!Bt(i.semver,String(f),r))return!1;if(!f.operator&&(i||s)&&0!==o)return!1}return!(s&&h&&!i&&0!==o||i&&u&&!s&&0!==o||p||c)},qt=(e,t,r)=>{if(!e)return t;const n=zt(e.semver,t.semver,r);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},Wt=(e,t,r)=>{if(!e)return t;const n=zt(e.semver,t.semver,r);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};var Zt=(e,t,r={})=>{if(e===t)return!0;e=new Ft(e,r),t=new Ft(t,r);let n=!1;e:for(const s of e.set){for(const e of t.set){const t=Yt(s,e,r);if(n=n||null!==t,t)continue e}if(n)return!1}return!0};const Kt=E,Jt=f,Qt=T,er=R,tr=(e,t,r)=>{const n=[];let s=null,i=null;const o=e.sort(((e,t)=>jt(e,t,r)));for(const u of o)Ut(u,t,r)?(i=u,s||(s=u)):(i&&n.push([s,i]),i=null,s=null);s&&n.push([s,null]);const a=[];for(const[u,c]of n)u===c?a.push(u):c||u!==o[0]?c?u===o[0]?a.push(`<=${c}`):a.push(`${u} - ${c}`):a.push(`>=${u}`):a.push("*");const l=a.join(" || "),h="string"==typeof t.raw?t.raw:String(t);return l.length<h.length?l:t};var rr={parse:P,valid:M,clean:D,inc:G,diff:j,major:k,minor:B,patch:V,prerelease:Y,compare:W,rcompare:K,compareLoose:Q,compareBuild:te,sort:ne,rsort:ie,gt:ae,lt:he,eq:ce,neq:fe,gte:Ee,lte:me,cmp:Ne,coerce:Pe,Comparator:it(),Range:st(),satisfies:at,toComparators:ht,maxSatisfying:pt,minSatisfying:Et,minVersion:It,validRange:Rt,outside:Pt,gtr:Mt,ltr:Dt,intersects:Gt,simplifyRange:tr,subset:Zt,SemVer:Qt,re:Kt.re,src:Kt.src,tokens:Kt.t,SEMVER_SPEC_VERSION:Jt.SEMVER_SPEC_VERSION,RELEASE_TYPES:Jt.RELEASE_TYPES,compareIdentifiers:er.compareIdentifiers,rcompareIdentifiers:er.rcompareIdentifiers};const nr=s(rr);var sr,ir,or=globalThis&&globalThis.__assign||function(){return or=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},or.apply(this,arguments)};!function(e){e.blue="blue",e.nanoS="nanoS",e.nanoSP="nanoSP",e.nanoX="nanoX",e.nanoFTS="nanoFTS"}(ir||(ir={}));var ar=((sr={})[ir.blue]={id:ir.blue,productName:"Ledger Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:491520,masks:[822083584,822149120],getBlockSize:function(e){return 4096}},sr[ir.nanoS]={id:ir.nanoS,productName:"Ledger Nano S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:327680,masks:[823132160],getBlockSize:function(e){var t;return nr.lt(null!==(t=nr.coerce(e))&&void 0!==t?t:"","2.0.0")?4096:2048}},sr[ir.nanoSP]={id:ir.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1572864,masks:[856686592],getBlockSize:function(e){return 32}},sr[ir.nanoX]={id:ir.nanoX,productName:"Ledger Nano X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2097152,masks:[855638016],getBlockSize:function(e){return 4096},bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},sr[ir.nanoFTS]={id:ir.nanoFTS,productName:"Ledger Nano FTS",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:2097152,masks:[857735168],getBlockSize:function(e){return 4096},bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]},sr);ir.blue,ir.nanoS,ir.nanoSP,ir.nanoX,ir.nanoFTS;var lr=Object.values(ar),hr=11415,ur=function(e){var t=lr.find((function(t){return t.legacyUsbProductId===e}));if(t)return t;var r=e>>8;return lr.find((function(e){return e.productIdMM===r}))},cr=[],pr={};for(var fr in ar){var vr=ar[fr],Er=vr.bluetoothSpec;if(Er)for(var dr=0;dr<Er.length;dr++){var mr=Er[dr];cr.push(mr.serviceUuid),pr[mr.serviceUuid]=pr[mr.serviceUuid.replace(/-/g,"")]=or({deviceModel:vr},mr)}}var gr=0,Ir=[],$r=function(e,t,r){var n={type:e,id:String(++gr),date:new Date};t&&(n.message=t),r&&(n.data=r),function(e){for(var t=0;t<Ir.length;t++)try{Ir[t](e)}catch(r){console.error(r)}}(n)};"undefined"!=typeof window&&(window.__ledgerLogsListen=function(e){return Ir.push(e),function(){var t=Ir.indexOf(e);-1!==t&&(Ir[t]=Ir[Ir.length-1],Ir.pop())}});var Rr,wr=globalThis&&globalThis.__extends||(Rr=function(e,t){return Rr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},Rr(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Rr(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),yr=globalThis&&globalThis.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(s,i){function o(e){try{l(n.next(e))}catch(t){i(t)}}function a(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))},Nr=globalThis&&globalThis.__generator||function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(a){i=[6,a],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},Sr=globalThis&&globalThis.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,s,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(a){s={error:a}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(s)throw s.error}}return o},Lr=[{vendorId:hr}],Ar=function(){return Promise.resolve(!(!window.navigator||!window.navigator.hid))},Or=function(){var e=navigator.hid;if(!e)throw new l("navigator.hid is not supported","HIDNotSupported");return e};function Tr(){return yr(this,void 0,void 0,(function(){var e;return Nr(this,(function(t){switch(t.label){case 0:return[4,Or().requestDevice({filters:Lr})];case 1:return e=t.sent(),Array.isArray(e)?[2,e]:[2,[e]]}}))}))}function br(){return yr(this,void 0,void 0,(function(){return Nr(this,(function(e){switch(e.label){case 0:return[4,Or().getDevices()];case 1:return[2,e.sent().filter((function(e){return e.vendorId===hr}))]}}))}))}e("default",function(e){function t(t){var r=e.call(this)||this;return r.channel=Math.floor(65535*Math.random()),r.packetSize=64,r.inputs=[],r.read=function(){return r.inputs.length?Promise.resolve(r.inputs.shift()):new Promise((function(e){r.inputCallback=e}))},r.onInputReport=function(e){var t=Buffer.from(e.data.buffer);r.inputCallback?(r.inputCallback(t),r.inputCallback=null):r.inputs.push(t)},r._disconnectEmitted=!1,r._emitDisconnect=function(e){r._disconnectEmitted||(r._disconnectEmitted=!0,r.emit("disconnect",e))},r.exchange=function(e){return yr(r,void 0,void 0,(function(){var t=this;return Nr(this,(function(r){switch(r.label){case 0:return[4,this.exchangeAtomicImpl((function(){return yr(t,void 0,void 0,(function(){var t,r,n,s,i,o,a,l,h;return Nr(this,(function(u){switch(u.label){case 0:r=(t=this).channel,n=t.packetSize,$r("apdu","=> "+e.toString("hex")),s=c(r,n),i=s.makeBlocks(e),o=0,u.label=1;case 1:return o<i.length?[4,this.device.sendReport(0,i[o])]:[3,4];case 2:u.sent(),u.label=3;case 3:return o++,[3,1];case 4:return(a=s.getReducedResult(l))?[3,6]:[4,this.read()];case 5:return h=u.sent(),l=s.reduceResponse(l,h),[3,4];case 6:return $r("apdu","<= "+a.toString("hex")),[2,a]}}))}))})).catch((function(e){if(e&&e.message&&e.message.includes("write"))throw t._emitDisconnect(e),new i(e.message);throw e}))];case 1:return[2,r.sent()]}}))}))},r.device=t,r.deviceModel="number"==typeof t.productId?ur(t.productId):void 0,t.addEventListener("inputreport",r.onInputReport),r}return wr(t,e),t.request=function(){return yr(this,void 0,void 0,(function(){var e,r;return Nr(this,(function(n){switch(n.label){case 0:return[4,Tr()];case 1:return e=Sr.apply(void 0,[n.sent(),1]),r=e[0],[2,t.open(r)]}}))}))},t.openConnected=function(){return yr(this,void 0,void 0,(function(){var e;return Nr(this,(function(r){switch(r.label){case 0:return[4,br()];case 1:return 0===(e=r.sent()).length?[2,null]:[2,t.open(e[0])]}}))}))},t.open=function(e){return yr(this,void 0,void 0,(function(){var r,n;return Nr(this,(function(s){switch(s.label){case 0:return[4,e.open()];case 1:return s.sent(),r=new t(e),n=function(t){e===t.device&&(Or().removeEventListener("disconnect",n),r._emitDisconnect(new h))},Or().addEventListener("disconnect",n),[2,r]}}))}))},t.prototype.close=function(){return yr(this,void 0,void 0,(function(){return Nr(this,(function(e){switch(e.label){case 0:return[4,this.exchangeBusyPromise];case 1:return e.sent(),this.device.removeEventListener("inputreport",this.onInputReport),[4,this.device.close()];case 2:return e.sent(),[2]}}))}))},t.prototype.setScrambleKey=function(){},t.isSupported=Ar,t.list=br,t.listen=function(e){var t=!1;return function(){return yr(this,void 0,void 0,(function(){var e;return Nr(this,(function(t){switch(t.label){case 0:return[4,br()];case 1:return(e=t.sent()).length>0?[2,e[0]]:[4,Tr()];case 2:return[2,t.sent()[0]]}}))}))}().then((function(r){if(r){if(!t){var n="number"==typeof r.productId?ur(r.productId):void 0;e.next({type:"add",descriptor:r,deviceModel:n}),e.complete()}}else e.error(new o("Access denied to use Ledger device"))}),(function(t){e.error(new o(t.message))})),{unsubscribe:function(){t=!0}}},t}(a))}}}));
